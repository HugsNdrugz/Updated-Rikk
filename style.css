/* === style.css === */
:root {
    /* Colors */
    --color-dark-bg: #121212; --color-surface: #1e1e1e; --color-primary: #bb86fc; --color-secondary: #03dac6; --color-error: #cf6679; --color-on-surface: #e0e0e0; --color-on-primary: #000000;
    --color-light-text: #f0f0f1; --color-mid-dark: #2c3e50; --color-grey-dark: #333333; --color-grey-mid: #757575; --color-grey-light: #bdbdbd; --color-grey-dim: #9e9e9e;
    --color-accent-gold: #f39c12; --color-accent-orange: #e67e22; --color-link-blue: #3498db; --color-success-green: #2ecc71; --color-danger-red: var(--color-error);
    --color-overlay-dark-strong: rgba(0, 0, 0, 0.9); --color-overlay-dark-medium: rgba(0, 0, 0, 0.65);
    --color-button-primary-bg: var(--color-primary); --color-button-primary-text: var(--color-on-primary); --color-button-primary-border: var(--color-primary);
    --color-button-secondary-bg: transparent; --color-button-secondary-text: var(--color-secondary); --color-button-secondary-border: var(--color-secondary);
    --color-disabled-bg: rgba(224, 224, 224, 0.12); --color-disabled-border: rgba(224, 224, 224, 0.12); --color-disabled-text: rgba(224, 224, 224, 0.38);
    --color-bubble-customer: #3E3E42; --color-bubble-customer-text: var(--color-on-surface); --color-bubble-rikk-main: var(--color-primary); --color-bubble-rikk-text: var(--color-on-primary); --color-bubble-narration: transparent; --color-bubble-narration-text: var(--color-grey-mid);
    --color-hub-action-main: var(--color-secondary); --color-hub-action-hover: #018786; --color-hub-inventory-main: var(--color-primary); --color-hub-inventory-hover: #7f39fb;
    /* Fonts */
    --font-body: 'Roboto', 'Open Sans', sans-serif; --font-display: 'Press Start 2P', 'Comic Neue', cursive;
    /* Sizes & Dimensions */
    --viewport-max-width: 480px; --viewport-border-radius: 12px; --phone-max-width: 320px; --phone-max-height: 70vh; --phone-border-radius: 28px; --phone-screen-inset-radius: calc(var(--phone-border-radius) - 10px); --modal-max-width: 420px; --modal-border-radius: 10px; --button-border-radius: 8px; --chat-bubble-border-radius: 18px; --icon-size: 22px;
    /* Spacing */
    --spacing-unit: 8px; --spacing-xs: calc(var(--spacing-unit) * 0.5); --spacing-sm: var(--spacing-unit); --spacing-md: calc(var(--spacing-unit) * 1.5); --spacing-lg: calc(var(--spacing-unit) * 2); --spacing-xl: calc(var(--spacing-unit) * 3);
    /* Transitions & Animations */
    --transition-duration-short: 0.2s; --transition-duration-medium: 0.4s; --transition-easing: ease-in-out;
    --transition-phone-slide: 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}
/* Base Styles & Reset */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: var(--font-body); background-color: #000000; color: var(--color-on-surface); min-height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; padding: var(--spacing-sm); }
/* Game Viewport */
#game-viewport { width: 100%; max-width: var(--viewport-max-width); height: 100vh; max-height: 900px; background-color: var(--color-dark-bg); border-radius: var(--viewport-border-radius); box-shadow: 0 10px 40px rgba(0,0,0,0.8); display: flex; flex-direction: column; overflow: hidden; position: relative; border: 1px solid var(--color-grey-dark); }
/* Screen Styles */
.screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; flex-direction: column; text-align: center; transition: opacity var(--transition-duration-medium) var(--transition-easing), visibility 0s var(--transition-duration-medium); visibility: hidden; opacity: 0; background-color: var(--color-dark-bg); }
.screen.active { display: flex; visibility: visible; opacity: 1; }
/* Game Screen Specific */
#game-screen { background: url(assets/images/game-screen-bg.jpg) center/cover; }
#splash-screen { background: url(assets/images/splash-screen-bg.jpg) center/cover; justify-content: center; align-items: center; z-index: 2000; }
.splash-title { font-family: var(--font-display); font-size: 2.5rem; color: var(--color-primary); text-shadow: 2px 2px 0px #000, 4px 4px 0px var(--color-secondary); margin-bottom: var(--spacing-lg); }
.loader { border: 4px solid rgba(255, 255, 255, 0.2); border-left-color: var(--color-secondary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-top: var(--spacing-xl); }
@keyframes spin { to { transform: rotate(360deg); } }
/* Overlay Screens (Start/End) */
.overlay-screen { justify-content: center; align-items: center; padding: var(--spacing-xl); }
.overlay-screen .screen-content { background-color: rgba(30, 30, 30, 0.9); padding: var(--spacing-xl) var(--spacing-xxl); border-radius: var(--modal-border-radius); box-shadow: 0 8px 25px rgba(0,0,0,0.6); border: 1px solid var(--color-grey-dark); }
#start-screen { background: url('assets/images/main-menu-bg.jpg') center/cover; }
h1, #start-screen-title { font-family: var(--font-display); font-size: 2.2rem; color: var(--color-primary); margin-bottom: var(--spacing-lg); text-shadow: 2px 2px 0 var(--color-dark-bg), 3px 3px 0 var(--color-secondary); }
/* HUD & Ticker */
#top-hud { width: 100%; background-color: rgba(18, 18, 18, 0.8); padding: var(--spacing-sm) var(--spacing-lg); display: flex; justify-content: space-around; font-weight: 700; border-bottom: 1px solid var(--color-grey-dark); font-size: 0.85rem; }
.hud-item { display: flex; align-items: center; gap: var(--spacing-xs); }
.hud-label { color: var(--color-grey-light); } .hud-value { color: var(--color-accent-gold); }
#event-ticker-container { background-color: rgba(18, 18, 18, 0.9); color: var(--color-secondary); padding: var(--spacing-xs) var(--spacing-lg); font-size: 0.8rem; text-align: center; font-weight: 700; border-bottom: 1px solid var(--color-grey-dark); }
/* Game Scene */
#game-scene { flex-grow: 1; width: 100%; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: flex-end; padding: var(--spacing-md); }
#knock-effect { font-family: var(--font-display); font-size: 2rem; color: var(--color-on-primary); background-color: var(--color-error); padding: var(--spacing-md) var(--spacing-xl); border-radius: var(--button-border-radius); animation: knockAnim 0.4s ease-out; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
@keyframes knockAnim { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
/* PHONE CONTAINER & STATES */
.phone-container { position: relative; width: 100%; max-width: var(--phone-max-width); height: var(--phone-max-height); background: #111; border-radius: var(--phone-border-radius); display: flex; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 0 4px rgba(50,50,50,0.8); border: 2px solid #000; transition: transform var(--transition-phone-slide), opacity var(--transition-duration-medium) var(--transition-easing); z-index: 50; }
.phone-container.is-offscreen { transform: translateY(120%); opacity: 0; }
.phone-container.chatting-game, .phone-container.home-screen-active, .phone-container.app-menu-game { transform: translateY(0); opacity: 1; }
.phone-screen-area { width: calc(100% - 12px);
  height: calc(100% - 12px);
  background: #000;
  position: relative;
  overflow: hidden;
  border-radius: var(--phone-screen-inset-radius);
  margin: 6px; }
.wallpaper { position: absolute; inset: 0; background: linear-gradient(135deg, #6e45e2 0%, #89d4cf 100%); opacity: 0.2; z-index: 1; }
/* Phone Hardware */
.volume-btn, .power-btn { position: absolute; background: #333; }
.volume-btn { left: -3px; top: 80px; width: 3px; height: 80px; } .power-btn { right: -3px; top: 100px; width: 3px; height: 50px; }
.notch { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 150px; height: 25px; background: #111; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px; z-index: 100; }
.notch .camera, .notch .speaker { position: absolute; top: 50%; }
.notch .camera { right: 25px; width: 8px; height: 8px; border-radius: 50%; background: #333; transform: translateY(-50%);}
.notch .speaker { left: 50%; width: 50px; height: 4px; background: #222; border-radius: 3px; transform: translate(-50%, -50%);}
.status-bar { display: flex; justify-content: space-between; padding: 10px 20px; color: white; font-size: 0.8rem; position: absolute; width: 100%; top: 0; left: 0; z-index: 90; }
.status-icons { display: flex; gap: 8px; }
.dock { position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); width: 85%; display: flex; justify-content: space-around; align-items: center; z-index: 100; }
.dock-icon { width: 45px; height: 45px; border-radius: 12px; background: rgba(255, 255, 255, 0.1); display: flex; justify-content: center; align-items: center; color: white; font-size: 1.3rem; cursor: pointer; transition: all 0.2s ease; }
.home-indicator { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); width: 100px; height: 5px; background: rgba(255, 255, 255, 0.5); border-radius: 5px; z-index: 100; }
/* Phone Content Views */
.phone-content-view { position: absolute; inset: 0; display: flex; flex-direction: column; z-index: 5; padding-top: 30px; }
.phone-content-view.hidden { display: none; }
/* Home Screen UI */
#android-home-screen .time-display { font-weight: 200; font-size: 3.5rem; text-align: center; margin-top: 20px; }
#android-home-screen .date-display { color: rgba(255, 255, 255, 0.7); text-align: center; margin-top: 10px; font-size: 1rem; }
.app-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding: 25px; }
.app-icon { display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: transform 0.2s ease; }
.app-icon i { font-size: 1.8rem; width: 50px; height: 50px; background: rgba(255,255,255,0.1); border-radius: 12px; display: grid; place-items: center; }
.app-icon .app-label { font-size: 0.7rem; opacity: 0.9; }
.app-icon:hover { transform: scale(1.1); }
/* Notification */
.notification { position: absolute; top: 40px; left: 15px; width: calc(100% - 30px); background: rgba(30, 30, 30, 0.7); backdrop-filter: blur(10px); border-radius: 15px; padding: 10px; color: white; animation: slideIn 0.5s forwards; display: none; border: 1px solid rgba(255, 255, 255, 0.2); z-index: 200; }
@keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
.notification-title { font-weight: bold; font-size: 0.9rem; margin-bottom: 4px; }
.notification-content { font-size: 0.8rem; opacity: 0.9; }


/* === NEW CHAT UI: Mock Chat Interaction Styles - Corrected for Rikk's Game === */

/* Overall mockchat container (Rikk's #game-chat-view) */
#game-chat-view.mockchat {
  background: #FCF7FF; /* Mockchat's screen background for overall chat view */
  background-image: linear-gradient(#FCF7FF, #e4eaf0); /* Mockchat's screen background for overall chat view */
  display: flex; /* Flex container for header, chat area, footer */
  flex-direction: column;
}

/* The actual chat message display area (Rikk's #chat-container-game.phone-chat-body) */
#chat-container-game.phone-chat-body {
  flex-grow: 1; /* Allow it to grow and fill available space */
  display: flex;
  flex-direction: column; /* Messages stack from top to bottom */
  padding: 1em;
  overflow-y: auto;
}

/* NEW: The spacer element that pushes content to the bottom */
.chat-spacer {
    flex-grow: 1; /* This is the magic property. It expands to fill all available space. */
    min-height: 10px; /* Give it a minimal height to prevent it from collapsing completely */
    transition: all 0.3s ease-in-out; /* Smooth transition when it shrinks */
}

/* @keyframes for the pop-in animation */
@keyframes mockchat-reply-pop {
  0% {
    opacity: 0;
    transform: translateY(1em) scale(0.7);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Base styles for all chat bubbles (Rikk's .chat-bubble) */
.chat-bubble {
  width: fit-content;
  max-width: 90%; /* Give a little more room */
  position: relative;
  padding: 0.75em 1em; /* Padding inside the bubble */
  box-shadow: 0 1px 10px rgba(0, 0, 0, 0.08); /* From mockchat .reply */
  font-size: 13px; /* Match Rikk's font size */
  line-height: 1.5; /* Match Rikk's line height */
  word-wrap: break-word; /* Ensure long words break */
  font-family: 'Lato', sans-serif;

  /* Animation properties */
  opacity: 0; /* Start hidden for animation */
  animation: mockchat-reply-pop cubic-bezier(0.18, 0.89, 0.32, 1.28) 0.4s forwards;
}

/* Styles for Rikk's (sent) messages */
.chat-bubble.rikk {
  background: var(--color-primary);
  color: var(--color-on-primary);
  border-radius: 12px 12px 4px 12px; /* TL TR BR BL */
  transform-origin: 100% 100%; /* Animate from bottom-right */
}

/* Styles for customer (received) messages */
.chat-bubble.customer {
  background: white;
  color: #283747;
  border-radius: 12px 12px 12px 4px; /* TL TR BR BL */
  transform-origin: 0% 100%; /* Animate from bottom-left */
}

/* Narration messages */
.chat-bubble.narration {
  background: none;
  color: var(--color-grey-mid);
  text-align: center;
  font-style: italic;
  font-size: 0.8rem;
  padding: var(--spacing-sm) 0;
  margin: var(--spacing-sm) auto; /* Center narration bubbles */
  box-shadow: none;
  border-top: 1px dashed var(--color-grey-dark);
  border-bottom: 1px dashed var(--color-grey-dark);
  border-radius: 0;
  max-width: 95%; /* Allow narration to be wider */
}

/* Container for avatar and bubble(s) */
.chat__conversation-board__message-container {
  display: flex;
  flex-direction: row; /* Default: avatar left, bubble right */
  align-items: flex-end; /* Align avatars and bubbles to bottom of their container */
  margin-bottom: 0.5em; /* Spacing between distinct message groups */
  width: 100%;
}

.chat__conversation-board__message-container.reversed {
  flex-direction: row-reverse; /* Rikk's messages: avatar right, bubble left */
}

/* Avatar element styling */
.chat__conversation-board__message__person {
  margin: 0 0.5em 0 0;
  flex-shrink: 0;
}

.chat__conversation-board__message-container.reversed .chat__conversation-board__message__person {
  margin: 0 0 0 0.5em;
}

.chat__conversation-board__message__person__avatar {
  height: 32px;
  width: 32px;
  overflow: hidden;
  border-radius: 50%;
  user-select: none;
  position: relative;
}

.chat__conversation-board__message__person__avatar img {
  height: 100%;
  width: auto;
  object-fit: cover;
}

/* Context wrapping the bubble */
.chat__conversation-board__message__context {
  display: flex;
  flex-direction: column;
  max-width: calc(100% - 40px); /* Account for avatar width + margin */
}

.chat__conversation-board__message-container.reversed .chat__conversation-board__message__context {
    align-items: flex-end; /* Make bubbles align to the right inside the context for Rikk */
}
.chat__conversation-board__message-container:not(.reversed) .chat__conversation-board__message__context {
    align-items: flex-start; /* Make bubbles align to the left inside the context for customer */
}

/* Speaker name inside the bubble */
.chat-bubble .speaker-name {
    font-weight: bold;
    margin-bottom: 4px;
    font-size: 0.75rem;
    display: block;
    opacity: 0.8;
}

/* Rikk's existing phone-footer-choices */
.phone-footer-choices {
    padding: var(--spacing-sm) var(--spacing-md);
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    background-color: var(--color-surface);
    border-top: 1px solid #3A3A3C;
    flex-shrink: 0;
}

/* Remaining Rikk-specific styles */
.phone-header { background-color: #2A2A2E; padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid #3A3A3C; text-align: center; flex-shrink: 0; position: relative; z-index: 60; display: flex; align-items: center; justify-content: center; }
#phone-title-game, #phone-title-game-apps { margin: 0; font-weight: bold; flex-grow: 1; }
.phone-back-button { position: absolute; left: 15px; background: none; border: none; color: var(--color-on-surface); font-size: 1rem; cursor: pointer; }
.choice-button { padding: var(--spacing-xs) var(--spacing-md); border: 1px solid var(--color-primary); border-radius: 20px; font-weight: 500; font-size: 0.8rem; cursor: pointer; transition: all var(--transition-duration-short); background-color: transparent; color: var(--color-primary); }
.choice-button:hover { background-color: var(--color-primary); color: var(--color-on-primary); }
.choice-button:disabled { background-color: var(--color-disabled-bg) !important; color: var(--color-disabled-text) !important; border-color: var(--color-disabled-border) !important; cursor: not-allowed; }
.choice-button.decline { border-color: var(--color-grey-mid); color: var(--color-grey-mid); }
.choice-button.decline:hover { background-color: var(--color-error); color: var(--color-on-primary); border-color: var(--color-error); }
/* Player Hub & Docked Phone Icon */
#player-hub { display: flex; justify-content: space-between; padding: var(--spacing-sm) var(--spacing-md); background-color: rgba(18,18,18,0.9); width: 100%; border-top: 1px solid var(--color-grey-dark); }
.hub-button { display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs); padding: var(--spacing-sm); font-weight: 700; font-size: 0.75rem; color: var(--color-on-surface); border: none; border-radius: var(--button-border-radius); cursor: pointer; background: transparent; flex-grow: 1; max-width: 120px; transition: background-color 0.2s; }
.hub-button .button-icon { width: calc(var(--icon-size) * 1.2); height: calc(var(--icon-size) * 1.2); }
#phone-docked-indicator { position: absolute; bottom: 80px; right: 20px; width: 50px; height: 50px; background: var(--color-primary); color: var(--color-on-primary); border-radius: 50%; display: grid; place-items: center; font-size: 1.5rem; cursor: pointer; z-index: 40; box-shadow: 0 4px 15px rgba(0,0,0,0.4); transition: transform 0.2s, opacity 0.2s; }
#phone-docked-indicator:hover { transform: scale(1.1); }
#phone-docked-indicator.hidden { opacity: 0; pointer-events: none; }
/* Inventory Modal */
#inventory-modal { display: none; position: absolute; inset: 0; background-color: var(--color-overlay-dark-strong); z-index: 1000; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.2s; }
#inventory-modal.active { display: flex; opacity: 1; }
.modal-content { background-color: var(--color-surface); border-radius: var(--modal-border-radius); width: 90%; max-width: var(--modal-max-width); max-height: 85vh; display: flex; flex-direction: column; border: 1px solid var(--color-grey-dark); transform: scale(0.95); opacity: 0; transition: transform 0.2s, opacity 0.2s; }
#inventory-modal.active .modal-content { transform: scale(1); opacity: 1; }
.modal-header { padding: var(--spacing-md) var(--spacing-lg); border-bottom: 1px solid var(--color-grey-dark); display: flex; justify-content: space-between; align-items: center; }
.close-modal-btn { font-size: 1.8rem; color: var(--color-on-surface); cursor: pointer; background: none; border: none; opacity: 0.7; transition: opacity 0.2s; }
.modal-body { padding: var(--spacing-lg); overflow-y: auto; flex-grow: 1; }
.inventory-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: var(--spacing-md); }
.inventory-item-card { padding: var(--spacing-sm); border: 1px solid var(--color-grey-dark); border-radius: var(--spacing-xs); background-color: var(--color-dark-bg); }
.inventory-item-card h4 { font-weight: 700; color: var(--color-primary); font-size: 0.9rem; }
.item-detail { font-size: 0.75rem; color: var(--color-grey-light); line-height: 1.4; }
.modal-footer { padding: var(--spacing-md) var(--spacing-lg); border-top: 1px solid var(--color-grey-dark); text-align: center; }
/* General Buttons */
.game-button { padding: var(--spacing-md) var(--spacing-xl); font-family: var(--font-display); font-size: 1rem; border: 2px solid; border-radius: var(--button-border-radius); cursor: pointer; transition: all 0.2s; }
.game-button.primary-action { background-color: var(--color-button-primary-bg); color: var(--color-button-primary-text); border-color: var(--color-button-primary-border); }
/* Utility */
.hidden { display: none !important; }